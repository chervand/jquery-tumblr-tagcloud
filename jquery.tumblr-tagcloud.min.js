/*
 * Copyright (C) 2012 Sascha Rudolph
 * Licensed under the BSD 3-Clause License
 * https://github.com/eremit/jquery-tumblr-tagcloud
 */(function(a){a.fn.tumblrTagCloud=function(b){function m(){d.html("Loading... "),a.ajax({url:c.url+"/api/read?num="+c.numPosts+"&start="+c.postCount,dataType:"xml",username:c.username||!1,password:c.password||!1,success:n,error:function(){d.append("<span>unable to query tag list.</span>")}})}function n(a){d.empty(),tags=a.getElementsByTagName("tag"),h=a.getElementsByTagName("posts"),i=h[0].getAttribute("total")-0;for(l=0;l<tags.length;l++)k=tags[l].textContent.replace(" ",""),f[k]?e[f[k]].count++:(f[k]=e.length,e.push({count:1,normalized:k,original:tags[l].textContent}));j<Math.min(i,c.maxPosts)?(j+=50,m()):o()}function o(){c.sortBy==="alpha"?g=e.sort(function(a,b){return a.normalized.localeCompare(b.normalized)}):c.sortBy==="bycount"?g=e.sort(function(a,b){return b.count-a.count}):c.sortBy==="random"?g=e.sort(function(a,b){return Math.round(Math.random())-.5}):a.extend(!0,g,e),d.empty(),jQuery.each(g,function(a,b){d.append(jQuery("<a>").attr({href:c.url+"/tagged/"+b.original,title:b.original+"["+b.count+"]"}).css("font-size",100+b.count+"%").html(b.original))})}var c=a.extend({numPosts:50,maxPosts:400,sortBy:!1,username:!1,password:!1},b),d=null,e=[],f={},g=[],h=[],i=0,j=0,k="",l;return this.each(function(){d=a(this),m()})}})(jQuery);